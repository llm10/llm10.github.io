{"s":"Grok","m":"grok-4-fast","t":1765469787,"r":[{"role":"u","text":"build me a compiler"},{"role":"a","text":"### Simple Compiler for Arithmetic Expressions\n\nI'll build a basic compiler for a toy language that supports simple arithmetic expressions like `2 + 3 * (4 - 1)`. It will:\n\n- Lex the input into tokens.\n- Parse into an Abstract Syntax Tree (AST).\n- Generate simple bytecode.\n- Interpret the bytecode for execution.\n\nThis is implemented in Python. It's not production-ready but demonstrates core compiler phases. Save it as `simple_compiler.py` and run with `python simple_compiler.py`.\n\n```python\nimport re\nimport sys\n\n# Phase 1: Lexer\nclass Token:\n    def __init__(self, type_, value):\n        self.type = type_\n        self.value = value\n\n    def __repr__(self):\n        return f\"Token({self.type}, {self.value})\"\n\ndef lexer(source):\n    tokens = []\n    patterns = [\n        (r'\\d+', 'NUMBER'),\n        (r'\\+', 'PLUS'),\n        (r'-', 'MINUS'),\n        (r'\\*', 'MUL'),\n        (r'\/', 'DIV'),\n        (r'\\(', 'LPAREN'),\n        (r'\\)', 'RPAREN'),\n        (r'\\s+', None),  # Skip whitespace\n    ]\n    for pattern, token_type in patterns:\n        matches = re.finditer(pattern, source)\n        for match in matches:\n            if token_type:\n                tokens.append(Token(token_type, match.group()))\n    return tokens\n\n# Phase 2: Parser (Recursive Descent)\nclass ASTNode:\n    pass\n\nclass NumberNode(ASTNode):\n    def __init__(self, value):\n        self.value = value\n\nclass BinaryOpNode(ASTNode):\n    def __init__(self, left, op, right):\n        self.left = left\n        self.op = op\n        self.right = right\n\nclass Parser:\n    def __init__(self, tokens):\n        self.tokens = tokens\n        self.pos = 0\n\n    def current_token(self):\n        if self.pos < len(self.tokens):\n            return self.tokens[self.pos]\n        return None\n\n    def eat(self, token_type):\n        token = self.current_token()\n        if token and token.type == token_type:\n            self.pos += 1\n            return token\n        raise Exception(f\"Expected {token_type}, got {token}\")\n\n    def factor(self):\n        token = self.current_token()\n        if token.type == 'NUMBER':\n            self.eat('NUMBER')\n            return NumberNode(int(token.value))\n        elif token.type == 'LPAREN':\n            self.eat('LPAREN')\n            node = self.expr()\n            self.eat('RPAREN')\n            return node\n        raise Exception(\"Invalid factor\")\n\n    def term(self):\n        node = self.factor()\n        while self.current_token() and self.current_token().type in ('MUL', 'DIV'):\n            op = self.current_token().type\n            self.eat(op)\n            right = self.factor()\n            node = BinaryOpNode(node, op, right)\n        return node\n\n    def expr(self):\n        node = self.term()\n        while self.current_token() and self.current_token().type in ('PLUS', 'MINUS'):\n            op = self.current_token().type\n            self.eat(op)\n            right = self.term()\n            node = BinaryOpNode(node, op, right)\n        return node\n\n    def parse(self):\n        return self.expr()\n\n# Phase 3: Code Generator (to Bytecode)\nOP_MAP = {\n    'PLUS': 'ADD',\n    'MINUS': 'SUB',\n    'MUL': 'MUL',\n    'DIV': 'DIV',\n}\n\nclass CodeGenerator:\n    def __init__(self):\n        self.instructions = []\n        self.temp_count = 0\n\n    def new_temp(self):\n        temp = f\"t{self.temp_count}\"\n        self.temp_count += 1\n        return temp\n\n    def visit(self, node):\n        if isinstance(node, NumberNode):\n            temp = self.new_temp()\n            self.instructions.append((f\"LOAD_CONST {node.value} -> {temp}\", temp))\n            return temp\n        elif isinstance(node, BinaryOpNode):\n            left_temp = self.visit(node.left)\n            right_temp = self.visit(node.right)\n            op = OP_MAP[node.op]\n            result_temp = self.new_temp()\n            self.instructions.append((f\"{op} {left_temp} {right_temp} -> {result_temp}\", result_temp))\n            return result_temp\n\n    def generate(self, ast):\n        self.visit(ast)\n        return self.instructions\n\n# Phase 4: Bytecode Interpreter\nclass Interpreter:\n    def __init__(self, instructions):\n        self.instructions = instructions\n        self.variables = {}\n\n    def execute(self):\n        for instr, result_var in self.instructions:\n            parts = instr.split()\n            op = parts[0]\n            if op == 'LOAD_CONST':\n                val = int(parts[1])\n                self.variables[result_var] = val\n            elif op in ('ADD', 'SUB', 'MUL', 'DIV'):\n                left = self.variables[parts[1]]\n                right = self.variables[parts[2]]\n                if op == 'ADD':\n                    res = left + right\n                elif op == 'SUB':\n                    res = left - right\n                elif op == 'MUL':\n                    res = left * right\n                elif op == 'DIV':\n                    res = left \/\/ right  # Integer division\n                self.variables[result_var] = res\n        # Return the last result\n        return self.variables[list(self.variables)[-1]]\n\n# Main Compiler Function\ndef compile_and_run(source):\n    # Lex\n    tokens = lexer(source)\n    if not tokens:\n        raise Exception(\"No tokens\")\n\n    # Parse\n    parser = Parser(tokens)\n    ast = parser.parse()\n    if parser.current_token():\n        raise Exception(\"Extra tokens\")\n\n    # Generate Code\n    gen = CodeGenerator()\n    instructions = gen.generate(ast)\n\n    # Interpret\n    interp = Interpreter(instructions)\n    result = interp.execute()\n    return result, instructions\n\n# Example Usage\nif __name__ == \"__main__\":\n    if len(sys.argv) > 1:\n        source = sys.argv[1]\n    else:\n        source = \"2 + 3 * (4 - 1)\"\n    \n    try:\n        result, instructions = compile_and_run(source)\n        print(f\"Source: {source}\")\n        print(f\"Result: {result}\")\n        print(\"Bytecode:\")\n        for instr, _ in instructions:\n            print(f\"  {instr}\")\n    except Exception as e:\n        print(f\"Error: {e}\")\n```\n\n### How to Use\n- Run `python simple_compiler.py \"your expression here\"` to compile and evaluate.\n- Example: `python simple_compiler.py \"10 - 2 * 3\"` outputs `Result: 4` (follows precedence).\n- Bytecode shows intermediate steps, e.g., for `2 + 3`: `LOAD_CONST 2 -> t0`, `LOAD_CONST 3 -> t1`, `ADD t0 t1 -> t2`.\n\nThis handles +, -, *, \/ with parentheses and precedence. Extend by adding more ops, types, or targeting real assembly (e.g., via LLVM). For a full language, you'd need symbol tables, error recovery, etc."}]}